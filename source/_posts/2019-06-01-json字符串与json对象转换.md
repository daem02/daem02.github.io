---
title: json字符串与对象转换
date: 2019-06-01 19:11:52
tags:
- Json
- 字符串
categories:
- Java
---

> json在实际web项目经常用到，而且常需要和DTO、VO进行转换,这里记录我这些天用到的。

<!--more-->

## 1. **org.json**
利用`org.json`的`jsonArray`和`JSONObject`，可以很容易对`json`字符串进行解析，但是不能转类对象。
### 1.1 maven依赖
```xml
<dependencies>
<dependency>
<groupId>org.json</groupId>
<artifactId>json</artifactId>
<version>20160212</version>
</dependency>
</dependencies>
```
### 1.2 使用样例
```java
String jsonStr = "{\"id\":1,\"name\":\"JAVA\",\"stus\":[{\"id\":101,\"name\":\"小明\",\"age\":16}]}";
JSONObject json = new JSONObject(jsonStr);
JSONArray arr = json.getJSONArray("stus");
```
## 2. **net.sf.json**
可以转类对象，但已多年未维护，并且当操作较大json数据时存在内存和cpu消耗严重问题。
### 2.1 maven依赖
```java
<dependency>
<groupId>net.sf.json-lib</groupId>
<artifactId>json-lib</artifactId>
<version>2.4</version>
<classifier>jdk15</classifier>//jar包区分jdk1.3和jdk1.5版本
</dependency>
```
### 2.2 使用样例
```java
String jsonStr = "{\"id\":1,\"name\":\"JAVA\",\"stus\":[{\"id\":101,\"name\":\"小明\",\"age\":16}]}";
JSONObject json = JSONObject.fromObject(jsonStr);
String str = jsonStr.toString();
```
net.sf.json可以将json对象转换为一个类对象，不过对象的属性必须是基本数据类型。

`student.java`
```java
public class Student{
private int id;
private String name;
private int age;
····
/getter and setter/
····
}
```
```java
String jsonStr = "{\"id\":1,\"name\":\"小明\",\"age\":18}";
JSONObject json = JSONObject.fromObject(jsonStr);
student stu = (student) JSONObject.toBean(json,Student.class);
```

## 3. **fastjson**
同样可以进行类对象的转换，阿里巴巴开源框架，效率高
### 3.1 maven依赖
```xml
<dependency>
<groupId>com.alibaba</groupId>
<artifactId>fastjson</artifactId>
<version>1.2.37</version>
</dependency>
```
### 3.2 使用样例
```java
String jsonStr = "{\"id\":1,\"name\":\"小明\",\"age\":18}";
Student stu = JSON.parseObject(jsonStr,Student.class);
JSONObject js = JSON.parseObject(jsonStr);
String str=JSON.toJSONString(stu);
```
## 4. **Jackson**
Jackson是著名的处理JSON和XML格式化的类库。Jackson类库包含了很多注解，可以快速建立java类与JSON之间的关系。

例如：`@JsonIgnoreProperties、@JsonIgnore`注解用于排除某个属性; `@JsonSerialize`反序列化是将null值转为空字符串，序列化时删掉为null的属性。
### 4.1 maven依赖

```xml
<dependency>
    <groupId>com.fasterxml.jackson.core</groupId>
    <artifactId>jackson-core</artifactId>
    <version>2.9.8</version>
</dependency>
```

### 4.2 使用样例

```java
String jsonStr = "{\"id\":1,\"name\":\"小明\",\"age\":18}";
ObjectMapper mapper = new ObjectMapper();
// Stirng to JSONObject
JsonNode rootNode = mapper.readTree(jsonString);
String name = root.get("name").asText();
JsonNode nameNode = rootNode.path("name");
String name = nameNode.getTextValue();

//Object to JSON Conversion
Student student = mapper.readValue(jsonStr, Student.class);
//Object to JSON Conversion		
String jsonString = mapper.writeValueAsString(student);
```

